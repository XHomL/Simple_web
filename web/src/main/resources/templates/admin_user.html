<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Creative - Bootstrap 3 Responsive Admin Template">
    <meta name="author" content="GeeksLabs">
    <meta name="keyword" content="Creative, Dashboard, Admin, Template, Theme, Bootstrap, Responsive, Retina, Minimal">
    <link rel="shortcut icon" href="img/favicon.png">

    <title>后台管理系统</title>

    <!-- Bootstrap CSS -->    
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!-- bootstrap theme -->
    <link href="/css/bootstrap-theme.css" rel="stylesheet">
    <!--external css-->
    <!-- font icon -->
    <link href="/css/elegant-icons-style.css" rel="stylesheet" />
    <link href="/css/font-awesome.min.css" rel="stylesheet" />
    <!-- Custom styles -->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/style-responsive.css" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 -->
    <!--[if lt IE 9]>
      <script src="/js/html5shiv.js"></script>
      <script src="/js/respond.min.js"></script>
      <script src="/js/lte-ie7.js"></script>
      <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
      <![endif]-->
  </head>

  <body>
  <!-- container section start -->
  <section id="container" class="">
      <!--header start-->
      <header class="header dark-bg">
            <div class="toggle-nav">
                <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
            </div>

            <!--logo start-->
            <a href="index.html" class="logo">Nice <span class="lite">Admin</span></a>
            <!--logo end-->

            <div class="nav search-row" id="top_menu">
                <!--  search form start -->
                <ul class="nav top-menu">                    
                    <li>
                        <form class="navbar-form">
                            <input class="form-control" placeholder="Search" type="text">
                        </form>
                    </li>                    
                </ul>
                <!--  search form end -->                
            </div>

            <div class="top-nav notification-row">                
                <!-- notificatoin dropdown start-->
                <ul class="nav pull-right top-menu">
                    
                    <!-- task notificatoin start -->
                    <li id="task_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="icon-task-l"></span>
                        </a>
                    </li>
                    <!-- task notificatoin end -->
					
                    <!-- inbox notificatoin start-->
                    <li id="mail_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="icon-envelope-l"></i>
                        </a>
                    </li>
                    <!-- inbox notificatoin end -->
					
                    <!-- alert notification start-->
                    <li id="alert_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="icon-bell-l"></i>
                        </a> 
                    </li>
                    <!-- alert notification end-->
					
                    <!-- user login dropdown start-->
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="profile-ava">
                                <img alt="" src="/imgs/avatar1_small.jpg">
                            </span>
                            <span class="username">Jenifer Smith</span>
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu extended logout">
                            <div class="log-arrow-up"></div>
                            <li class="eborder-top">
                                <a href="#"><i class="icon_profile"></i> My Profile</a>
                            </li>
                            <li>
                                <a href="#"><i class="icon_mail_alt"></i> My Inbox</a>
                            </li>
                            <li>
                                <a href="#"><i class="icon_clock_alt"></i> Timeline</a>
                            </li>
                            <li>
                                <a href="#"><i class="icon_chat_alt"></i> Chats</a>
                            </li>
                            <li>
                                <a href="login.html"><i class="icon_key_alt"></i> Log Out</a>
                            </li>
                            <li>
                                <a href="documentation.html"><i class="icon_key_alt"></i> Documentation</a>
                            </li>
                            <li>
                                <a href="documentation.html"><i class="icon_key_alt"></i> Documentation</a>
                            </li>
                        </ul>
                    </li>
                    <!-- user login dropdown end -->
                </ul>
                <!-- notificatoin dropdown end-->
            </div>
      </header>      
      <!--header end-->

      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu">                
                  <li class="">
                      <a class="" href="index.html">
                          <i class="icon_house_alt"></i>
                          <span>Dashboard</span>
                      </a>
                  </li>
				  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon_document_alt"></i>
                          <span>用户管理</span>
                          <span class="menu-arrow arrow_carrot-right"></span>
                      </a>
                      <ul class="sub">
                          <li><a class="" href="/admin_user">普通用户</a></li>
                          <li><a class="" href="/admin_manager">管理用户</a></li>
                      </ul>
                  </li>       
                  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon_desktop"></i>
                          <span>商品管理</span>
                          <span class="menu-arrow arrow_carrot-right"></span>
                      </a>
                      <ul class="sub">
                          <li><a class="" href="/admin_virtual_flowers">虚拟鲜花</a></li>
                          <li><a class="" href="/admin_flowers">实物鲜花</a></li>
                          <li><a class="" href="/admin_gifts">实际礼品</a></li>
                      </ul>
                  </li>
                  <li>
                      <a class="" href="/admin_order">
                          <i class="icon_genius"></i>
                          <span>订单管理</span>
                      </a>
                  </li>
                  <li>                     
                      <a class="" href="/admin_pay">
                          <i class="icon_piechart"></i>
                          <span>花芽购买管理</span> 
                      </a>                   
                  </li>
                             
                  <li>
                      <a class="" href="/admin_withdrawal">
                          <i class="icon_table"></i>
                          <span>花芽提现管理</span>
                      </a>
                  </li>
                  
                  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon_documents_alt"></i>
                          <span>Pages</span>
                          <span class="menu-arrow arrow_carrot-right"></span>
                      </a>
                      <ul class="sub">                          
                          <li><a class="" href="/admin_login"><span>Login Page</span></a></li>e
                          <li><a class="" href="/404">404 Error</a></li>
                      </ul>
                  </li>
              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>

      <!--main content start-->
      <section id="main-content">
	  
          <section class="wrapper">
		    <div class="row">
				<div class="col-lg-12">
					<ol class="breadcrumb">
						<li><i class="fa fa-home"></i><a href="/index">Home</a></li>
						<li><i class="fa fa-table"></i>Table</li>
					</ol>
				</div>
			</div>
		  
		  
		  
			<div class="btn-group">
                <button type="button" class="btn btn-default" >刷新</button>
            </div>
			
			<div class="row">
					<div class="col-lg-12">
                      <section class="panel">
                          <header class="panel-heading">
                              Common users
                          </header>
						  <div class="table-responsive">
                          <table class="table" id="table">
                            <thead>
                              <tr>
                                 <th>#userid</th>
								 <th EditType="TextBox">username</th>
								 <th EditType="TextBox">realname</th>
								 <th EditType="TextBox">sex</th>
								 <th EditType="TextBox">birthday</th>
								 <th EditType="TextBox">address</th>
								 <th EditType="TextBox">phonenum</th>
								 <th EditType="TextBox">signature</th>
								 <th EditType="TextBox">bud</th>
								 <th EditType="TextBox">corolla</th>
								 <th EditType="TextBox">password</th>
                                 <th EditType="TextBox">Action</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                 <td>1</td>
								 <td>xiaoming</td>
								 <td>song</td>
								 <td>female</td>
								 <td>19980819</td>
								 <td>xxxxxxxxxx</td>
								 <td>xxxxxxxxxx</td>
								 <td>xxxxxxxxxx</td>
								 <td>500</td>
								 <td>500</td>
								 <td>12345678</td>
                                 <td>
								 <div class="btn-group">
                                      <a class="btn btn-primary" href="#" onclick="changeCurrentRow(this)"><i class="icon_plus_alt2"></i></a>
                                      <a class="btn btn-danger" href="#" onclick="deleteCurrentRow(this)"><i class="icon_close_alt2" ></i></a>
                                  </div>
								 </td>
                              </tr>
							  <tr>
                                 <td>2</td>
								 <td>xiaoming</td>
								 <td>jing</td>
								 <td>female</td>
								 <td>19980819</td>
								 <td>xxxxxxxxxx</td>
								 <td>xxxxxxxxxx</td>
								 <td>xxxxxxxxxx</td>
								 <td>500</td>
								 <td>500</td>
								 <td>12345678</td>
                                 <td>
								 <div class="btn-group">
                                      <a class="btn btn-primary" href="#" onclick="changeCurrentRow(this)"><i class="icon_plus_alt2"></i></a>
                                      <a class="btn btn-danger" href="#" onclick="deleteCurrentRow(this)"><i class="icon_close_alt2" ></i></a>
                                  </div>
								 </td>
                              </tr>                               
                            </tbody>
                          </table>
						  </div>
                      </section>
                  </div>
				</div>
          </section>

		  
      </section>
      <!--main content end-->
  </section>
  <!-- container section end -->
    <!-- javascripts -->
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- nicescroll -->
    <script src="/js/jquery.scrollTo.min.js"></script>
    <script src="/js/jquery.nicescroll.js" type="text/javascript"></script>
    <!--custome script for all page-->
    <script src="/js/scripts.js"></script>
	<script>
	
	window.onload = function()
	{  
		  $.ajax({
			type:"POST",  
			url:"/getUserList",//连接对应后台
			dataType: "json", 
			error:function(data){  
				  alert("连接超时");  
			  },  
			   success:function(data){  
				   $("#table").html("<tr><th>#id</th><th EditType=\"TextBox\">用户名</th><th EditType=\"TextBox\">真名</th><th EditType=\"TextBox\">性别</th><th EditType=\"TextBox\">生日</th><th EditType=\"TextBox\">地址</th><th EditType=\"TextBox\">电话</th><th EditType=\"TextBox\">个性签名</th><th EditType=\"TextBox\">花芽</th><th EditType=\"TextBox\">花冠</th><th EditType=\"TextBox\">密码</th><th EditType=\"TextBox\">Action</th>");
				   for( i in data){
					   $("#table").append("<tr><td>"+data[i].userId+
							   "</td><td>"+data[i].username+
							   "</td><td>"+data[i].realName+
							   "</td><td>"+data[i].sex+
							   "</td><td>"+data[i].birthday+
							   "</td><td>"+data[i].address+
							   "</td><td>"+data[i].phoneNum+
							   "</td><td>"+data[i].signature+
							   "</td><td>"+data[i].bud+
							   "</td><td>"+data[i].corolla+
							   "</td><td>"+data[i].password+
							   "</td><td>"+"<div class=\"btn-group\">"+
							   "<a class=\"btn btn-primary\" href=\"#\" onclick=\"changeCurrentRow(this)\"><i class=\"icon_plus_alt2\"></i></a>"+
							   "<a class=\"btn btn-success\" href=\"#\" onclick=\"submitCurrentRow(this)\"><i class=\"icon_check_alt2\"></i></a>"+
							   "<a class=\"btn btn-danger\" href=\"#\"onclick=\"deleteCurrentRow(this)\"><i class=\"icon_close_alt2\" ></i></a>"+
							   "</div>"+
							   "</td></tr>")
					 }
				  }  
			  });  
	}//findall
		   
		   
	</script>
	
	<script type="text/javascript">
        function deleteCurrentRow(obj) {
            var tr = obj.parentNode.parentNode.parentNode;//找到tr 

            var id = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[0].innerText;//找到这一行的id

            var tbody = tr.parentNode;
            if (window.confirm("是否确定删除？") == true) {
                tbody.removeChild(tr);
                //只剩行首时删除表格
                if (tbody.rows.length == 0) {
                    tbody.parentNode.removeChild(tbody);
                }
                //后台删除
                $.ajax({
                    type: "POST",
                    url: "/deleteUser",//连接对应后台 删除这个用户
                    dataType: "json",
					contentType: "application/json",
                    data: JSON.stringify({"userId": id}),//用户id
                    error: function (result) {
                        alert("连接超时");
                    },
                    success: function (result) {
                        alert("success");
                    }
                });
            }
        }
    </script>
	<script type="text/javascript">
		function changeCurrentRow(obj) {

			//找到这一行的tr
			var tr = obj.parentNode.parentNode.parentNode;
			//找到这一行的id
			var id = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[0].innerText;
			//获取本行所有的td
			var td = tr.getElementsByTagName("td");
			//将这一行每个单元格变成输入框
			for(var i=0;i<td.length-1; i++)
			{
			td[i].index = i;
			
			td[i].onclick = function () {
            
                var input = document.createElement("input");
                input.type = "text";
                input.className = "inputOne";
                input.value = this.innerHTML;
                td[this.index].innerHTML = "";
                td[this.index].appendChild(input);
                input.focus();
                input.onblur = function () {
                    this.parentNode.innerHTML = input.value;                                                            
					input.remove();
				}
				
			}
			}
			
   
        }
		
		
		
		
	</script>
	<script type="text/javascript">
	function submitCurrentRow(obj){
			var id = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[0].innerText;
			var username = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[1].innerText;
			var realname = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[2].innerText;
			var sex = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[3].innerText;
			var birthday = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[4].innerText;
			var address = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[5].innerText;
			var phonenum = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[6].innerText;
			var signature = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[7].innerText;
			var bud = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[8].innerText;
			var corolla = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[9].innerText;
			var password = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[10].innerText;
			
			

                $.ajax({
                    type: "POST",
                    url: "/updateUser",//连接对应后台 更新这个用户
                    contentType: "application/json",
                    data: JSON.stringify({"userId": id,"username":username,"realName": realname,"sex": sex,"birthday": birthday,"address": address,"phoneNum": phonenum,"signature": signature,"bud": bud,"corolla": corolla,"password": password}),//用户信息全部重传
                    error: function (result) {
                        alert("连接超时");
                    },
                    success: function (result) {
                        alert("success");
                    }
                });
	        
	}

    </script>  


  </body>
</html>
