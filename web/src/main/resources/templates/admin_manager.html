<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Creative - Bootstrap 3 Responsive Admin Template">
    <meta name="author" content="GeeksLabs">
    <meta name="keyword" content="Creative, Dashboard, Admin, Template, Theme, Bootstrap, Responsive, Retina, Minimal">
    <link rel="shortcut icon" href="img/favicon.png">
    <script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>

    <title>后台管理系统</title>

    <!-- Bootstrap CSS -->    
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <!-- bootstrap theme -->
    <link href="/css/bootstrap-theme.css" rel="stylesheet">
    <!--external css-->
    <!-- font icon -->
    <link href="/css/elegant-icons-style.css" rel="stylesheet" />
    <link href="/css/font-awesome.min.css" rel="stylesheet" />
    <!-- Custom styles -->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/style-responsive.css" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 -->
    <!--[if lt IE 9]>
      <script src="https://cdn.bootcss.com/jquery-cookie/1.3.0/jquery.cookie.js"></script>
      <script src="/js/html5shiv.js"></script>
      <script src="/js/respond.min.js"></script>
      <script src="/js/lte-ie7.js"></script>

      <![endif]-->
  </head>

  <body>
  <!-- container section start -->
  <section id="container" class="">
      <!--header start-->
      <header class="header dark-bg">
            <div class="toggle-nav">
                <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
            </div>

            <!--logo start-->
            <a href="index.html" class="logo">Nice <span class="lite">Admin</span></a>
            <!--logo end-->

            <div class="nav search-row" id="top_menu">
                <!--  search form start -->
                <ul class="nav top-menu">                    
                    <li>
                        <form class="navbar-form">
                            <input class="form-control" placeholder="Search" type="text">
                        </form>
                    </li>                    
                </ul>
                <!--  search form end -->                
            </div>

            <div class="top-nav notification-row">                
                <!-- notificatoin dropdown start-->
                <ul class="nav pull-right top-menu">
                    
                    <!-- task notificatoin start -->
                    <li id="task_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="icon-task-l"></span>
                        </a>
                    </li>
                    <!-- task notificatoin end -->
					
                    <!-- inbox notificatoin start-->
                    <li id="mail_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="icon-envelope-l"></i>
                        </a>
                    </li>
                    <!-- inbox notificatoin end -->
					
                    <!-- alert notification start-->
                    <li id="alert_notificatoin_bar" class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <i class="icon-bell-l"></i>
                        </a> 
                    </li>
                    <!-- alert notification end-->
					
                    <!-- user login dropdown start-->
                    <li class="dropdown">
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="profile-ava">
                                <img alt="" src="/imgs/avatar1_small.jpg">
                            </span>
                            <span class="username">Jenifer Smith</span>
                            <b class="caret"></b>
                        </a>
                        <ul class="dropdown-menu extended logout">
                            <div class="log-arrow-up"></div>
                            <li class="eborder-top">
                                <a href="#"><i class="icon_profile"></i> My Profile</a>
                            </li>
                            <li>
                                <a href="#"><i class="icon_mail_alt"></i> My Inbox</a>
                            </li>
                            <li>
                                <a href="#"><i class="icon_clock_alt"></i> Timeline</a>
                            </li>
                            <li>
                                <a href="#"><i class="icon_chat_alt"></i> Chats</a>
                            </li>
                            <li>
                                <a href="login.html"><i class="icon_key_alt"></i> Log Out</a>
                            </li>
                            <li>
                                <a href="documentation.html"><i class="icon_key_alt"></i> Documentation</a>
                            </li>
                            <li>
                                <a href="documentation.html"><i class="icon_key_alt"></i> Documentation</a>
                            </li>
                        </ul>
                    </li>
                    <!-- user login dropdown end -->
                </ul>
                <!-- notificatoin dropdown end-->
            </div>
      </header>      
      <!--header end-->

      <!--sidebar start-->
      <aside>
          <div id="sidebar"  class="nav-collapse ">
              <!-- sidebar menu start-->
              <ul class="sidebar-menu">                
                  <li class="">
                      <a class="" href="index.html">
                          <i class="icon_house_alt"></i>
                          <span>Dashboard</span>
                      </a>
                  </li>
				  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon_document_alt"></i>
                          <span>用户管理</span>
                          <span class="menu-arrow arrow_carrot-right"></span>
                      </a>
                      <ul class="sub">
                          <li><a class="" href="/admin_user">普通用户</a></li>
                          <li><a class="" href="/admin_manager">管理用户</a></li>
                      </ul>
                  </li>       
                  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon_desktop"></i>
                          <span>商品管理</span>
                          <span class="menu-arrow arrow_carrot-right"></span>
                      </a>
                      <ul class="sub">
                          <li><a class="" href="/admin_virtual_flowers">虚拟鲜花</a></li>
                          <li><a class="" href="/admin_flowers">实物鲜花</a></li>
                          <li><a class="" href="/admin_gifts">实际礼品</a></li>
                      </ul>
                  </li>
                  <li>
                      <a class="" href="/admin_order">
                          <i class="icon_genius"></i>
                          <span>订单管理</span>
                      </a>
                  </li>
                  <li>                     
                      <a class="" href="/admin_pay">
                          <i class="icon_piechart"></i>
                          <span>花芽购买管理</span> 
                      </a>                   
                  </li>
                             
                  <li>
                      <a class="" href="/admin_withdrawal">
                          <i class="icon_table"></i>
                          <span>花芽提现管理</span>
                      </a>
                  </li>
                  
                  <li class="sub-menu">
                      <a href="javascript:;" class="">
                          <i class="icon_documents_alt"></i>
                          <span>Pages</span>
                          <span class="menu-arrow arrow_carrot-right"></span>
                      </a>
                      <ul class="sub">                          
                          <li><a class="" href="/admin_login"><span>Login Page</span></a></li>e
                          <li><a class="" href="/404">404 Error</a></li>
                      </ul>
                  </li>
              </ul>
              <!-- sidebar menu end-->
          </div>
      </aside>

      <!--main content start-->
      <section id="main-content">
	  
          <section class="wrapper">
		    <div class="row">
				<div class="col-lg-12">
					<ol class="breadcrumb">
						<li><i class="fa fa-home"></i><a href="index.html">Home</a></li>
						<li><i class="fa fa-table"></i>Table</li>
					</ol>
				</div>
			</div>
		  
		  
		  
			<div class="btn-group">
                <button type="button" class="btn btn-default" onclick="display('lb')">添加</button>
                <button type="button" class="btn btn-default" >刷新</button>
            </div>					
			
								
				
              <div class="row">
                  <div class="col-lg-12">
                      <section class="panel">
                          <header class="panel-heading">
                              Advanced Table
                          </header>
                          
                        <table class="table table-striped table-advance table-hover" id = "table">
                           <tbody>
                              <tr>
                                 <th>#</th>
                                 <!--<th><i class="icon_calendar"></i> Date</th>
                                 <th><i class="icon_mail_alt"></i> Email</th>
                                 <th><i class="icon_pin_alt"></i> City</th>
                                 <th><i class="icon_mobile"></i> Mobile</th>-->
								 <th><i class="icon_profile"></i>name</th>
								 <th><i class="icon_mobile"></i>password</th>
                                 <th><i class="icon_cogs"></i> Action</th>
                              </tr>
                              <tr>
							     <td>1</td>
                                 <td>Angeline Mcclain</td>
                                 <td>176-026-5992</td>
                                 <td>
                                  <div class="btn-group">
                                      <a class="btn btn-primary" href="#" onclick="changeCurrentRow(this)"><i class="icon_plus_alt2"></i></a>
                                      <a class="btn btn-danger" href="#" onclick="deleteCurrentRow(this)"><i class="icon_close_alt2" ></i></a>
                                  </div>
                                  </td>
                              </tr>
                              <tr>
							     <td>2</td>
                                 <td>Sung Carlson</td>
                                 <td>724-639-4784</td>
                                 <td>
                                  <div class="btn-group">
                                      <a class="btn btn-primary" href="#" onclick="changeCurrentRow(this)"><i class="icon_plus_alt2" ></i></a>
                                      <a class="btn btn-danger" href="#" onclick="deleteCurrentRow(this)"><i class="icon_close_alt2" ></i></a>
                                  </div>
                                  </td>
                              </tr>
                           </tbody>
                        </table>
                      </section>
                  </div>
              </div>
              <!-- page end-->
          </section>
		  <div class="col-lg-6" id="lb"  style="display:none">
				<section class="panel">
				<header class="panel-heading">
					 添加用户
				</header>
				<div class="panel-body">
					
						<div class="form-group">
							<label for= "exampleInputEmail1">Admin name</label>
							<input class="form-control" id="adminname" placeholder="Enter name">
						</div>
						<div class="form-group">
							<label for= "exampleInputPassword1">Password</label>
							<input type="password" class="form-control" id="adminPassword" placeholder="Password">
						</div>
						
						<button type="submit" class="btn btn-primary"  id = "sub1">Submit</button>
					

				</div>
				</section>
			</div>	
		  		
		  
      </section>
      <!--main content end-->
  </section>
  <!-- container section end -->
    <!-- javascripts -->
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- nicescroll -->
    <script src="/js/jquery.scrollTo.min.js"></script>
    <script src="/js/jquery.nicescroll.js" type="text/javascript"></script>
    <!--custome script for all page-->
    <script src="/js/scripts.js"></script>
    <script src="http://www.gongjuji.net/Content/files/jquery.md5.js"></script>
	<script>
	window.onload = function()
	{  
		  $.ajax({
			type:"POST",  
			url:"/getManagerList",//连接对应后台
			dataType: "json", 
			error:function(data){  
				  alert("连接超时");  
			  },  
			   success:function(data){  
				   $("#table").html("<tr><td>#id</td><td>用户名</td><td>密码</td><td>Action</td></tr>");
				   for( i in data){
					   $("#table").append("<tr><td>"+data[i].managerId+
							   "</td><td>"+data[i].managerName+
							   "</td><td>"+data[i].password+
							   "</td><td>"+"<div class=\"btn-group\">"+
							   "<a class=\"btn btn-primary\" href=\"#\" onclick=\"changeCurrentRow(this)\"><i class=\"icon_plus_alt2\"></i></a>"+
							   "<a class=\"btn btn-danger\" href=\"#\"onclick=\"deleteCurrentRow(this)\"><i class=\"icon_close_alt2\" ></i></a>"+
							   "</div>"+
							   "</td></tr>")
					 }
				  }  
			  });  
		   }//findall
	</script>
	
	<script type="text/javascript">
        function deleteCurrentRow(obj) {
            var tr = obj.parentNode.parentNode.parentNode;

            var id = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[0].innerText;//找到这一行的id

            var tbody = tr.parentNode;
            if (window.confirm("是否确定删除？") == true) {
                tbody.removeChild(tr);
                //只剩行首时删除表格
                if (tbody.rows.length == 1) {
                    tbody.parentNode.removeChild(tbody);
                }
                //后台删除
                $.ajax({
                    type: "POST",
                    url: "/getRealProductionList",//连接对应后台 删除这个用户
                    dataType: "json",
                    data: {"managerId": id},//用户id
                    error: function (result) {
                        alert("连接超时");
                    },
                    success: function (result) {
                        alert("success");
                    }
                });
            }
        }
    </script>
	<script type="text/javascript">
		function changeCurrentRow(obj) {

            //operatorCell1.innerHTML ="<input class="form-control" type="text" value="+"operatorCell1.innerHTML"+"/>";//把内容变成文本框
            //operatorCell1.innerHTML =operatorCell1.getElementsByTagName("input")[0].value;//把文本框变成内容

            var passwd = window.prompt("请输入新的密码", "");
            if (passwd !== "" && (passwd.length >= 6 && passwd.length <= 16)) {
                var operatorCell1 = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[2];//取到要操作的td对象
                operatorCell1.innerHTML = passwd;

                var id = obj.parentNode.parentNode.parentNode.getElementsByTagName("td")[0].innerText;//找到这一行的id

                passwd=$.md5(passwd);
                var user = new FormData();
                user.append("password", passwd);
                user.append("userId", id);
                $.ajax({
                    type: "POST",
                    url: "/getRealProductionList",//连接对应后台 更新这个用户
                    contentType: "application/json",
                    data: JSON.stringify({"managerId": id,"password": passwd}),
                    error: function (result) {
                        alert("连接超时");
                    },
                    success: function (result) {
                        alert("success");
                    }
                });
            } else{
		    if (passwd == ""){
		        alert("密码不能为空");
		    }else{
		        alert("长度应该为6-16位");
            }
            }

        }
	</script>

<script type="text/javascript">
    function display(id){  

        var traget=document.getElementById(id);  

        if(traget.style.display=="none"){  

            traget.style.display="";  

        }else{  

            traget.style.display="none";  

      }  

   }  

</script>
<script type="text/javascript">

document.getElementById('sub1').onclick = function(){
  var c=document.getElementById('table');//获得表格的信息

  var t1 = c.rows.length;//获得表格有多少行

  var t2 = $("#adminname").val();
  var t3 = $("#adminPassword").val();
  t3=$.md5(t3);


  if ( c.rows.length==0)//如果是向一个空表增加一行
  {
  var x=c.insertRow(0);//向空表插入一行
  var y1=x.insertCell(0);//向新行插入一列
  var y2=x.insertCell(0);
  var y3=x.insertCell(0);
  y1.innerHTML="new cell0";
  }
  else {
      var x = c.insertRow(-1);

      //依次向新行插入表格列数的单元格12`
      x.innerHTML = "<td>" + parseInt(t1) + "</td>";
      x.innerHTML += "<td>" + t2.value + "</td>";
      x.innerHTML += "<td>" + t3.value + "</td>";
      x.innerHTML += "<td><div class=\"btn-group\"><a class=\"btn btn-primary\" href=\"#\" onclick=\"changeCurrentRow(this)\"><i class=\"icon_plus_alt2\"></i></a><a class=\"btn btn-danger\" href=\"#\" onclick=\"deleteCurrentRow(this)\"><i class=\"icon_close_alt2\" ></i></a></div></td>";
  }

   $.ajax({
			type:"POST",
			url:"/addManager",//连接对应后台 增加这个用户
            contentType: "application/json",
			dataType: "json",
			data:JSON.stringify({"managerName":t2,"password":t3}),//tr1是用户id
			error:function(result){
              alert("连接超时");
			},
			success:function(result){
                alert("success");
              }
            });
}
</script>
  </body>
</html>
